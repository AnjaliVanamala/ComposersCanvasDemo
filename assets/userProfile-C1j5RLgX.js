import{e as u,g as A,c as n,a as V,b as t,u as a,h as x,f as c,F as k,i as D,t as b,w as v,v as y,o as s}from"./index-B4MUP9Zt.js";import{_ as N,N as P}from"./Navbar-DRIAE21-.js";import{u as S,a as h}from"./auth-BNEtBXxm.js";const E={class:"profile-container"},$={key:0},F={key:0},T={key:0},B=["onClick"],Y={key:1},I={key:1},L={key:2},M={class:"input-group"},O={key:3},R={class:"input-group"},H={key:1},j={__name:"userProfile",setup(q){const i=S(),p=u([]),d=u(""),m=u(""),f=u(""),r=u(!1);async function w(l){const e=encodeURIComponent(l);window.location.href=`CanvasView.html?from=profile&title=${e}`}async function g(){try{const e=await h.get("undefined/get_compositions",{withCredentials:!0});p.value=e.data}catch(l){console.error("Error fetching compositions:",l)}}async function C(){if(!d.value.trim()){alert("Please enter a composition title.");return}try{await h.post("undefined/delete_composition",{name:d.value},{withCredentials:!0}),alert("Composition deleted successfully."),g()}catch(l){console.error("Error deleting composition:",l),alert("Failed to delete composition. Please try again.")}}async function _(){if(confirm("Are you sure you want to permanently delete your account?"))try{await h.post("undefined/delete_user",{username:m.value,password:f.value},{withCredentials:!0}),alert("Your account has been deleted."),await i.logout(),window.location.href="/"}catch(e){console.error("Error deleting account:",e),alert("Failed to delete account. Please try again.")}}return A(async()=>{await i.checkAuthStatus(),i.isAuthenticated&&await g()}),(l,e)=>(s(),n(k,null,[V(P),t("div",E,[e[9]||(e[9]=t("h1",null,"User Profile",-1)),a(i).isAuthenticated?(s(),n("p",$,[e[8]||(e[8]=x(" You are logged in! ",-1)),t("button",{class:"btn logout-btn",onClick:e[0]||(e[0]=(...o)=>a(i).logout&&a(i).logout(...o))},"Logout"),a(i).isAuthenticated?(s(),n("section",F,[e[5]||(e[5]=t("h2",null,"Your Saved Compositions",-1)),p.value.length?(s(),n("ul",T,[(s(!0),n(k,null,D(p.value,(o,U)=>(s(),n("li",{key:U,onClick:z=>w(o.name)},b(o.name),9,B))),128))])):(s(),n("p",Y,"No saved compositions found."))])):c("",!0),a(i).isAuthenticated?(s(),n("section",I,[t("button",{onClick:e[1]||(e[1]=o=>r.value=!r.value),class:"btn toggle-deletion-btn"},b(r.value?"Hide Deletion Options":"Show Deletion Options"),1)])):c("",!0),r.value&&a(i).isAuthenticated?(s(),n("section",L,[e[6]||(e[6]=t("h2",null,"Delete a Composition",-1)),t("div",M,[v(t("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>d.value=o),type:"text",placeholder:"Enter composition title to delete",class:"input"},null,512),[[y,d.value]]),t("button",{onClick:C,class:"btn delete-btn"},"Delete Composition")])])):c("",!0),r.value&&a(i).isAuthenticated?(s(),n("section",O,[e[7]||(e[7]=t("h2",null,"Delete Account",-1)),t("div",R,[v(t("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>m.value=o),type:"text",placeholder:"Re-enter your username",class:"input"},null,512),[[y,m.value]]),v(t("input",{"onUpdate:modelValue":e[4]||(e[4]=o=>f.value=o),type:"password",placeholder:"Enter your password",class:"input"},null,512),[[y,f.value]]),t("button",{onClick:_,class:"btn delete-btn"},"Delete Account")])])):c("",!0)])):(s(),n("p",H," Please log in to view account details. "))])],64))}},Q=N(j,[["__scopeId","data-v-9fe466bf"]]);export{Q as default};
